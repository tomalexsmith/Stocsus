{% extends "base.html" %}
{% block header %}
{#    <link rel="stylesheet" href="{{ url_for('static', filename='css/results.css') }}">#}
{% endblock %}
{% block content %}
{#    <link rel="stylesheet" href="/static/styles.css" />#}
    <body>
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="{{ url_for('static', filename='app.js') }}"></script>

    <h1>Results</h1>

      {% if no_tables_available != True %}
    <form method="POST"><button type="submit" name="download_result"
                            formmethod="POST">Download</button>
                   </form>
    {% endif %}


    <h3>Favourites/Blacklist will apply next time you search</h3>
    <h3>Visit Dashboard to look at them/update them</h3>


    {% if no_tables_available == True %}
     {{ no_tables }}
    <table>
    <p>Stock availability for the following parts does not match the search criteria</p>
    <tr>
        <th>
          part_number
        </th>
        <th>
          watchlist
        </th>
    </tr>
         {% for i in no_stock_numbers_no_tables %}
            <tr>
            <td>
                {{ i }}</td>
                {% if i not in watchlist_check %}
        <td class="add_watchlist_{{ i }} add_watchlist" part_number="{{ i }}"><button class="watchlist_button_{{ i }} watchlist_button" part_number="{{ i }}">Add to Watchlist</button></td>
        {% else %}
            <td>Already on watchlist</td>
                </tr>
        {% endif %}
    {% endfor %}
    </table>
    {% endif %}


    {% for i in tables %}

        <h3>{{ "Part number: " + part_number[i] + " " + "Manufacturer: " + manufacturer[i] }}</h3>
        <table class="table">
            <tr class="table__header">
                {% for header in headings %}
                    <th class="table__cell">{{ header }}</th>
                {% endfor %}
                    <th> favourite </th>
                    <th> blacklist </th>
            </tr>
            {% for row in tables[i] %}
                {% if row[0] not in blacklist_check  %}

            <tr class="table__row">
                <td class="check"><a href="{{ row[3] }}">{{ row[0] }}</a></td>
                <td>{{ row[1] }}</td>
                <td>{{ row[2] }}</td>
                {% if row[0] not in favourite_check %}
               <td><button class="fav_btn_{{ row[0] }} fav_btn" supplier_name="{{ row[0] }}">&#x2661;</button></td>
                {% endif %}
                 {% if row[0] not in favourite_check and row[0] not in blacklist_check %}
                <td class="blacklist_supplier_{{ row[0] }} blacklist_supplier"><button class="blacklist_btn_{{ row[0] }} blacklist_btn" supplier_name="{{ row[0] }}">&#129683;</button></td>
                     {% else %}
                     <td>‚ù§</td>
                {% endif %}
            </tr>
                {% endif %}
            {% endfor %}
        </table>
        <br>
    {% endfor %}
    <br>
    <br>
    {% with errors = get_flashed_messages(category_filter=["watchlist_duplicate"]) %}
        {% if errors %}
        <div class="alert-message block-message error">
            {{ errors[0] }}
        </div>
        {% endif %}
        {% endwith %}


    {% if no_stock_numbers %}
    <table>
    <p>Stock availability for the following parts does not match the search criteria</p>
    <tr>
        <th>
          part_number
        </th>
        <th>
          watchlist
        </th>
    </tr>
         {% for i in no_stock_numbers %}
            <tr>
            <td>
                {{ i }}</td>
                {% if i not in watchlist_check %}
        <td class="add_watchlist_{{ i }} add_watchlist" part_number="{{ i }}"><button class="watchlist_button_{{ i }} watchlist_button" part_number="{{ i }}">Add to Watchlist</button></td>
        {% else %}
            <td>Already on watchlist</td>
                </tr>
        {% endif %}
    {% endfor %}
    </table>
    {% endif %}
    </body>
{% endblock %}
